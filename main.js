(()=>{"use strict";function e(e,t,n,o,r){var c=e.querySelector(".places__item").cloneNode(!0),a=c.querySelector(".card__image");a.src=t.link,a.alt=t.name,c.querySelector(".card__title").textContent=t.name;var i=c.querySelector(".card__delete-button"),s=c.querySelector(".card__like-button");return i.addEventListener("click",n),a.addEventListener("click",(function(){return r({cardImage:a})})),s.addEventListener("click",o),c}function t(e){e.target.classList.toggle("card__like-button_is-active")}function n(e){e.target.closest(".places__item").remove()}function o(e){e.target===e.currentTarget&&a(document.querySelector(".popup_is-opened"))}function r(e){"Escape"===e.key&&a(document.querySelector(".popup_is-opened"))}function c(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",r)}function a(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",r)}var i=new Object({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_error",errorClass:"input_error_active"}),s=function(e,t){e.querySelectorAll(t.inputSelector).forEach((function(n){n.classList.remove(t.inputErrorClass);var o=e.querySelector(".".concat(n.id,"_error"));o.classList.remove(t.errorClass),o.textContent=""}))},u=function(e,t,n,o){t.validity.valueMissing?l(e,t,t.dataset.missValue,n,o):t.validity.patternMismatch?l(e,t,t.dataset.errorPattern,n,o):t.validity.valid?d(e,t,n,o):l(e,t,t.validationMessage,n,o)},l=function(e,t,n,o,r){var c=e.querySelector(".".concat(t.id,"_error"));t.classList.add(r.inputErrorClass),c.textContent=n,c.classList.add(r.errorClass),n="",m(o,r.inactiveButtonClass)},d=function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"_error"));t.classList.remove(o.inputErrorClass),r.classList.remove(o.errorClass),r.textContent="",p(e,n,o)},p=function(e,t,n){var o=Array.from(e.querySelectorAll(n.inputSelector)),r=!0;o.forEach((function(e){!e.classList.contains(n.inputErrorClass)&&e.value||(r=!1)})),r&&f(t,n.inactiveButtonClass)},f=function(e,t){e.disabled=!1,e.classList.remove(t)},m=function(e,t){e.disabled=!0,e.classList.add(t)};function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var v=document.querySelector(".places__list"),_=document.querySelector("#card-template").content,b=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__add-button"),S=document.querySelector(".popup_type_edit"),g=S.querySelector(".popup__button"),k=document.querySelector(".popup_type_new-card"),q=k.querySelector(".popup__button"),C=document.querySelector(".popup_type_image");[S,k,C].forEach((function(e){e.classList.add("popup_is-animated"),e.addEventListener("click",o),e.querySelector(".popup__close").addEventListener("click",(function(){return a(e)}))}));var E=C.querySelector(".popup__caption"),L=C.querySelector(".popup__image");g.addEventListener("click",(function(e){var t,n;e.preventDefault(),t=w.value,n=j.value,fetch("https://nomoreparties.co/v1/wff-cohort-21/users/me",{method:"PATCH",headers:{authorization:"dabdb893-c1db-47a5-b9ab-3ce5d0407d83","Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){console.log(e),e.ok?console.log("Данные профиля отправлены. Сервер вернул статус: ".concat(e.status)):console.error("Ошибка при передаче данных профиля на сервер. Статус ответа: ".concat(e.status))})),A.textContent=w.value,O.textContent=j.value,a(S)})),q.addEventListener("click",(function(o){o.preventDefault();var r,c=new Object;c.name=B["place-name"].value,c.link=B.link.value,r=c,fetch("https://nomoreparties.co/v1/wff-cohort-21/cards",{method:"POST",headers:{authorization:"dabdb893-c1db-47a5-b9ab-3ce5d0407d83","Content-Type":"application/json"},body:JSON.stringify({name:r.name,link:r.link})}).then((function(e){console.log(e),e.ok?console.log("Данные карточки отправлены. Сервер вернул статус: ".concat(e.status)):console.error("Ошибка при передаче данных карточки на сервер. Статус ответа: ".concat(e.status))})),v.prepend(e(_,c,n,t,P)),B.reset(),m(B.querySelector(".popup__button"),"popup__button_disabled"),a(k)}));var x,w=S.querySelector(".popup__input_type_name"),j=S.querySelector(".popup__input_type_description"),A=document.querySelector(".profile__title"),O=document.querySelector(".profile__description"),I=document.querySelector(".profile__image"),T=document.forms["edit-profile"],B=document.forms["new-place"];function P(e){E.textContent=e.cardImage.alt,L.alt=e.cardImage.alt,L.src=e.cardImage.src,c(C)}b.addEventListener("click",(function(){s(T,i),w.value=A.textContent,j.value=O.textContent,c(S)})),h.addEventListener("click",(function(){B.reset(),s(B,i),c(k)})),T.name.value=A.textContent,T.description.value=O.textContent,[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(o){v.append(e(_,o,n,t,P))})),x=i,Array.from(document.querySelectorAll(x.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(n){n.addEventListener("input",(function(){u(e,n,o,t)}))}))}(e,x),"new-place"===e.name&&m(e.querySelector(x.submitButtonSelector),x.inactiveButtonClass)})),Promise.all([new Promise((function(e,t){fetch("https://nomoreparties.co/v1/wff-cohort-21/users/me",{method:"GET",headers:{authorization:"dabdb893-c1db-47a5-b9ab-3ce5d0407d83"}}).then((function(n){n.ok?(console.log("successfull getProfileInfo"),e(n.json())):t("Ошибка при запросе данных пользователя. Статус запроса: ".concat(n.status))}))})).catch((function(e){console.error(e)})),new Promise((function(e,t){fetch("https://nomoreparties.co/v1/wff-cohort-21/cards",{method:"GET",headers:{authorization:"dabdb893-c1db-47a5-b9ab-3ce5d0407d83"}}).then((function(n){n.ok?(console.log("successfull getCards"),e(n.json())):t("Ошибка при запросе карточек. Статус запроса: ".concat(n.status))}))})).catch((function(e){console.error(e)}))]).then((function(o){var r,c,a,i=(a=2,function(e){if(Array.isArray(e))return e}(c=o)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c,a,i=[],s=!0,u=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=c.call(n)).done)&&(i.push(o.value),i.length!==t);s=!0);}catch(e){u=!0,r=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return i}}(c,a)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(c,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=i[0],u=i[1];r=s,A.textContent=r.name,O.textContent=r.about,I.style="background-image: url(".concat(r.avatar,")"),r._id,function(o){console.log("HERE",o),o.forEach((function(o){console.log(o),o.owner._id,v.append(e(_,o,n,t,P)),o.querySelector(".card__delete-button")}))}(u)})).catch((function(){console.error("При загрузке данных возникла ошибка.")}))})();